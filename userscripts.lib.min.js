var $=jQuery;var options=null,location=""+document.location,downloadURL=GM_info.scriptMetaStr.split("@downloadURL")[1].split("\n")[0].trim();var browser=function(t){var n="unknown";if(GM_info.scriptHandler==="Tampermonkey")n="chrome";else if(typeof window.opera!=="undefined")n="opera";else if(typeof GM_info.scriptWillUpdate==="number")n="opera";else if(typeof GM_info.scriptWillUpdate==="boolean")n="firefox";return typeof t==="undefined"?n:n===t};var site=function(t){var n="";var r=location.split(/^http(s)?\:\/\/(www\.)?/)[3].split("/")[0];if(typeof r!=="undefined")n=r.split(/\.[a-zA-Z](\.[a-zA-Z])?/)[0];else n=null;return typeof t==="undefined"?n:n===t};var get_data=function(t){t.post=typeof t.post==="undefined"?false:t.post;var n="";if(typeof t.post==="object")for(var r in t.post)n+=(n===""?"":"&")+r+"="+t.post[r];GM_xmlhttpRequest({method:t.post===false?"GET":"POST",data:n,url:t.url,onload:function(e){var n=$.parseHTML(e.responseText);if(typeof t.onload==="function")t.onload(n,e)},ontimeout:function(e){var n=$.parseHTML(e.responseText);if(typeof t.ontimeout==="function")t.ontimeout(n,e)},onerror:function(e){var n=$.parseHTML(e.responseText);if(typeof t.onerror==="function")t.onerror(n,e)}})};var init=function(t){if(GM_getValue("options",null)===null)GM_setValue("options",JSON.stringify(t));options=JSON.parse(GM_getValue("options"))};var showOptions=function(){var e={the_pirate_bay:{tpb_location:{text:"URL",type:"text",binding:options.tpb_location,"default":"thepiratebay.se"},tpb_protocol:{text:"Protocol",type:"switch",binding:options.tpb_protocol,options:["HTTP","HTTPS"],"default":"HTTPS"},removeDead:{text:"Remove dead torrents",type:"checkbox","default":true}},watchfreeinhd:{direct_video:{text:"Direct video link",type:"checkbox","default":true},auto_accept:{text:"Auto click accept",type:"checkbox","default":true}}};var t={the_pirate_bay:"The Pirate Bay",watchfreeinhd:"Watch Free In HD"};var n=null,r,i,s,o,u,a,f;var l=function(){get_data({url:tracker_address+"tpb_location",onload:function(e,t){$("#option-tpb_location").val(t.responseText)}})};var c=function(){n=$('<div id="tph_options"></div>');n.css({"border-radius":"1em",width:"84%",position:"absolute",padding:"1em","padding-top":"2.5em",left:"8%",top:"25%",border:"1px solid black","z-index":"1000000","background-color":"gray"});r=$("<button>Save</button>");r.click(h);r.css({position:"absolute",left:"1em",top:".75em"});n.append(r);i=$("<button>Update Script</button>");i.click(function(){check_version(function(){alert("No update necessary")})});i.css({position:"absolute",left:"50%",top:".75em"});n.append(i);s=$("<button>Close</button>");s.click(function(){n.hide()});s.css({position:"absolute",right:"1em",top:".75em"});n.append(s);a=$("<button>Default TPB Location</button>");a.click(l);a.css({position:"absolute",left:"20%",top:".75em"});n.append(a);for(var o in e){var u=e[o];n.append($('<h2 style="background-color: #E0E0E0; border-bottom: 1px solid black; border-top: 1px solid black; margin-bottom: .25em; width: 100%; text-align: center; clear: both; color: gray; padding: 0; margin: 0; margin-top: 1em">'+t[o]+"</h2>"));for(var f in u){var c=u[f];var p='<div style="clear: both;"><label style="float: left; width: 40%; padding-right: 2%; text-align: right; clear: both" for="option-'+f+'">'+c.text+"</label>";if(c.type==="text")p+='<input id="option-'+f+'" type="text" value="'+options[f]+'"></input>';else if(c.type==="switch"){p+='<select id="option-'+f+'">';for(var d=0;d<c.options.length;d++)p+="<option"+(options[f]===c.options[d].toLowerCase()?" SELECTED":"")+">"+c.options[d]+"</option>";p+="</select>"}else if(c.type==="checkbox")p+='<input type="checkbox" id="option-'+f+'"'+(options[f]===true?" CHECKED":"")+"></input>";p+="</div>";n.append($(p))}}body.append(n)};var h=function(){options.tpb_location=$("#option-tpb_location").val().replace(/(http(s)?\:|\/|\\)/g,"");options.tpb_protocol=$("#option-tpb_protocol").val().toLowerCase();options.removeDead=$("#option-removeDead").is(":checked");options.direct_video=$("#option-direct_video").is(":checked");options.auto_accept=$("#option-auto_accept").is(":checked");saveOptions();n.hide()};if(n===null)c();else n.show()};var saveOptions=function(t){if(typeof t!=="undefined")for(var n in t)options[n]=t[n];GM_setValue("options",JSON.stringify(options))};var GM_execute=function(t){if(window.top===window.self){var n=$("#"+t);if(n.length===0){$(document.body).append($('<span id="'+t+'"></span>'));return true}}return false}